# üõ†Ô∏è API REST - E-Commerce Cata Sucata

API REST para o sistema de e-commerce **Cata Sucata**, constru√≠da em **Java + Spring Boot**, seguindo os modelos e nomes utilizados nos diagramas do projeto:

- `Cliente`
- `Endereco`
- `Item`
- `Pedido`
- `ItemPedido`

A API permite cadastrar clientes, endere√ßos, itens (produtos) e realizar pedidos com itens associados.

---

## üöÄ Tecnologias utilizadas

- Java 17+
- Spring Boot (Web, Data JPA)
- MySQL (ou outro banco relacional configurado em `application.properties`)
- Maven

---

## üìÅ Estrutura do projeto

Pacote principal:

`com.example.catasucata`

Principais pacotes:

- `model` ‚Üí Entidades JPA (`Cliente`, `Endereco`, `Item`, `Pedido`, `ItemPedido`, `ItemPedidoId`)
- `repository` ‚Üí Interfaces que estendem `JpaRepository`
- `service` ‚Üí Regras de neg√≥cio (ex: `PedidoService`)
- `controller` ‚Üí Endpoints REST (`ClienteController`, `EnderecoController`, `ItemController`, `PedidoController`)

Classe principal (ponto de entrada da aplica√ß√£o):

```java
com.example.catasucata.CatasucataApplication
```

---

## üóÑÔ∏è Configura√ß√£o do banco de dados

A configura√ß√£o do banco est√° no arquivo:

```text
src/main/resources/application.properties
```

Se voc√™ estiver usando MySQL, o arquivo costuma ter algo semelhante a:

```properties
spring.datasource.url=jdbc:mysql://localhost:3306/catasucata?createDatabaseIfNotExist=true&useSSL=false&serverTimezone=UTC
spring.datasource.username=SEU_USUARIO
spring.datasource.password=SUA_SENHA

spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
```

> ‚úÖ **Passos:**
> 1. Crie um banco de dados no MySQL, por exemplo: `catasucata`.
> 2. Ajuste `username` e `password` no `application.properties`.
> 3. Garanta que o MySQL esteja rodando.

---

## ‚ñ∂Ô∏è Como executar o projeto

### 1. Usando IntelliJ IDEA

1. Abra o IntelliJ IDEA.
2. Clique em **File > Open...**.
3. Selecione a pasta do projeto (onde est√° o `pom.xml`) e clique em **OK**.
4. Aguarde o Maven baixar as depend√™ncias.
5. No painel de projeto, abra o pacote `com.example.catasucata` e localize:
   - `CatasucataApplication`
6. Clique com o bot√£o direito na classe ‚Üí **Run 'CatasucataApplication'**.

A aplica√ß√£o iniciar√° na porta padr√£o:

```text
http://localhost:8080
```

### 2. Usando Maven pela linha de comando

Na pasta do projeto:

```bash
mvn spring-boot:run
```

---

## üåê Endpoints da API

### üßç‚Äç‚ôÇÔ∏è Cliente (`/clientes`)

Controller: `ClienteController`

| M√©todo | Endpoint          | Descri√ß√£o                          |
|--------|-------------------|------------------------------------|
| POST   | `/clientes`       | Cadastrar novo cliente            |
| GET    | `/clientes`       | Listar todos os clientes          |
| GET    | `/clientes/{id}`  | Buscar cliente por ID             |
| PUT    | `/clientes/{id}`  | Atualizar dados de um cliente     |
| DELETE | `/clientes/{id}`  | Remover cliente                   |

üì¶ **Exemplo de JSON para cadastro de cliente:**

```json
{
  "nome": "Jo√£o da Silva",
  "email": "joao.silva@example.com",
  "cpf": "12345678900",
  "telefone": "11999999999"
}
```

> ‚ö†Ô∏è Os campos exatos podem variar conforme sua entidade `Cliente`.
> Verifique a classe `Cliente` em `src/main/java/com/example/catasucata/model/Cliente.java`.

---

### üìç Endere√ßo (`/enderecos`)

Controller: `EnderecoController`

| M√©todo | Endpoint                    | Descri√ß√£o                                  |
|--------|-----------------------------|--------------------------------------------|
| POST   | `/enderecos/{clienteId}`    | Cadastrar endere√ßo para um cliente         |
| GET    | `/enderecos`               | Listar todos os endere√ßos                  |
| GET    | `/enderecos/{id}`          | Buscar endere√ßo por ID                     |

üì¶ **Exemplo de JSON para cadastro de endere√ßo:**

```json
{
	"rua": "Rua linda",
	"cidade": "Belo Horizonte",
	"cep": "30140001"
}
```

Requisi√ß√£o:

```http
POST /enderecos/1
Content-Type: application/json
```

---

### üì¶ Item (`/itens`)

Controller: `ItemController`

| M√©todo | Endpoint        | Descri√ß√£o                      |
|--------|-----------------|--------------------------------|
| GET    | `/itens`        | Listar todos os itens         |
| GET    | `/itens/{id}`   | Buscar item por ID            |
| POST   | `/itens`        | Cadastrar novo item           |
| PUT    | `/itens/{id}`   | Atualizar item existente      |
| DELETE | `/itens/{id}`   | Remover item                  |

üì¶ **Exemplo de JSON para cadastro de item:**

```json
{
  "nome": "Sucata de Ferro",
  "descricao": "Ferro recicl√°vel",
  "preco": 50.0,
  "estoque": 100
}
```

---

### üßæ Pedido (`/pedidos`)

Controller: `PedidoController`
Regra de neg√≥cio principal: `PedidoService`

| M√©todo | Endpoint                  | Descri√ß√£o                                             |
|--------|---------------------------|-------------------------------------------------------|
| POST   | `/pedidos/{clienteId}`    | Criar pedido para um cliente com lista de itens      |
| GET    | `/pedidos`               | Listar todos os pedidos                               |
| GET    | `/pedidos/{id}`          | Buscar pedido por ID                                  |

üìù **Como criar um pedido**

- Endpoint:

```http
POST /pedidos/{clienteId}
Content-Type: application/json
```

- Corpo da requisi√ß√£o: **lista de itens** (`ItemPedido`), cada um com um `item` (produto) e `quantidade`:

```json
[
  {
    "item": { "id": 1 },
    "quantidade": 2
  },
  {
    "item": { "id": 3 },
    "quantidade": 5
  }
]
```

üëâ O `PedidoService` faz automaticamente:

- Verifica√ß√£o se o cliente existe.
- Verifica√ß√£o se cada item existe.
- Valida√ß√£o de estoque.
- Desconto da quantidade do estoque.
- C√°lculo do `valorTotal` do pedido.
- Associa√ß√£o dos `ItemPedido` ao `Pedido`.

üì§ **Resposta (exemplo simplificado):**

```json
{
  "id": 10,
  "cliente": {
    "idCliente": 1,
    "nome": "Jo√£o da Silva"
  },
  "valorTotal": 350.0,
  "itens": [
    {
      "item": { "id": 1, "nome": "Sucata de Ferro" },
      "quantidade": 2,
      "precoUnitario": 50.0
    },
    {
      "item": { "id": 3, "nome": "Alum√≠nio" },
      "quantidade": 5,
      "precoUnitario": 50.0
    }
  ]
}
```

---

## üîç Testando com Postman/Insomnia

Ordem sugerida para testar:

1. **Cadastrar Cliente**
   `POST /clientes` ‚Üí cria um cliente e anota o `id` retornado.
2. **Cadastrar Itens**
   `POST /itens` ‚Üí cria alguns itens com `estoque` e `preco`.
3. **Criar Pedido**
   `POST /pedidos/{clienteId}` ‚Üí usando o `id` do cliente criado e os `id` dos itens.
4. **Listar Pedidos**
   `GET /pedidos` ou `GET /pedidos/{id}` para ver o resultado.

---

## üß© Relacionando com os diagramas

- **Diagrama de Classes**
  Cada classe (`Cliente`, `Endereco`, `Item`, `Pedido`, `ItemPedido`) est√° mapeada com `@Entity` em `model/`.
- **Diagrama de Casos de Uso**
  - "Cadastrar Cliente" ‚Üí `POST /clientes`
  - "Listar Clientes" ‚Üí `GET /clientes`
  - "Cadastrar Item" ‚Üí `POST /itens`
  - "Realizar Pedido" ‚Üí `POST /pedidos/{clienteId}`
  - "Consultar Pedido" ‚Üí `GET /pedidos/{id}`

Voc√™ pode usar esses relacionamentos na documenta√ß√£o/relat√≥rio do trabalho.

---

## ‚úÖ Observa√ß√µes finais

- Ajuste os exemplos de JSON conforme os atributos exatos das suas entidades.
- Se mudar o banco ou porta, atualize o `application.properties`.
- Lembre-se de sempre iniciar o banco de dados antes de subir a aplica√ß√£o.

---
